{"version":3,"sources":["file:///Users/bane/cocos-3.x-qrcode2/assets/scripts/QRUtil.ts"],"names":["QRMode","QRMaskPattern","QRMath","QRPolynomial","QRUtil","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","getBCHTypeInfo","data","d","getBCHDigit","getBCHTypeNumber","digit","getPatternPosition","typeNumber","getMask","maskPattern","i","j","PATTERN000","PATTERN001","PATTERN010","PATTERN011","PATTERN100","Math","floor","PATTERN101","PATTERN110","PATTERN111","Error","getErrorCorrectPolynomial","errorCorrectLength","a","multiply","gexp","getLengthInBits","mode","type","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","getLostPoint","qrCode","moduleCount","getModuleCount","lostPoint","row","col","sameCount","dark","isDark","r","c","count","darkCount","ratio","abs"],"mappings":"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","sourcesContent":["import { QRMode, QRMaskPattern } from './constants'\nimport { QRMath } from './QRMath'\nimport QRPolynomial from './QRPolynomial'\n\nexport const QRUtil = {\n  PATTERN_POSITION_TABLE: [\n    [],\n    [6, 18],\n    [6, 22],\n    [6, 26],\n    [6, 30],\n    [6, 34],\n    [6, 22, 38],\n    [6, 24, 42],\n    [6, 26, 46],\n    [6, 28, 50],\n    [6, 30, 54],\n    [6, 32, 58],\n    [6, 34, 62],\n    [6, 26, 46, 66],\n    [6, 26, 48, 70],\n    [6, 26, 50, 74],\n    [6, 30, 54, 78],\n    [6, 30, 56, 82],\n    [6, 30, 58, 86],\n    [6, 34, 62, 90],\n    [6, 28, 50, 72, 94],\n    [6, 26, 50, 74, 98],\n    [6, 30, 54, 78, 102],\n    [6, 28, 54, 80, 106],\n    [6, 32, 58, 84, 110],\n    [6, 30, 58, 86, 114],\n    [6, 34, 62, 90, 118],\n    [6, 26, 50, 74, 98, 122],\n    [6, 30, 54, 78, 102, 126],\n    [6, 26, 52, 78, 104, 130],\n    [6, 30, 56, 82, 108, 134],\n    [6, 34, 60, 86, 112, 138],\n    [6, 30, 58, 86, 114, 142],\n    [6, 34, 62, 90, 118, 146],\n    [6, 30, 54, 78, 102, 126, 150],\n    [6, 24, 50, 76, 102, 128, 154],\n    [6, 28, 54, 80, 106, 132, 158],\n    [6, 32, 58, 84, 110, 136, 162],\n    [6, 26, 54, 82, 110, 138, 166],\n    [6, 30, 58, 86, 114, 142, 170]\n  ],\n\n  G15: (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0),\n  G18: (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0),\n  G15_MASK: (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1),\n\n  getBCHTypeInfo (data: any) {\n    let d = data << 10\n    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0) {\n      d ^= QRUtil.G15 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15))\n    }\n    return ((data << 10) | d) ^ QRUtil.G15_MASK\n  },\n\n  getBCHTypeNumber (data: any) {\n    let d = data << 12\n    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0) {\n      d ^= QRUtil.G18 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18))\n    }\n    return (data << 12) | d\n  },\n\n  getBCHDigit (data: any) {\n    let digit = 0\n    while (data !== 0) {\n      digit++\n      data >>>= 1\n    }\n    return digit\n  },\n\n  getPatternPosition (typeNumber: any) {\n    return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1]\n  },\n\n  getMask (maskPattern: any, i: number, j: number) {\n    switch (maskPattern) {\n      case QRMaskPattern.PATTERN000:\n        return (i + j) % 2 === 0\n      case QRMaskPattern.PATTERN001:\n        return i % 2 === 0\n      case QRMaskPattern.PATTERN010:\n        return j % 3 === 0\n      case QRMaskPattern.PATTERN011:\n        return (i + j) % 3 === 0\n      case QRMaskPattern.PATTERN100:\n        return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 === 0\n      case QRMaskPattern.PATTERN101:\n        return ((i * j) % 2) + ((i * j) % 3) === 0\n      case QRMaskPattern.PATTERN110:\n        return (((i * j) % 2) + ((i * j) % 3)) % 2 === 0\n      case QRMaskPattern.PATTERN111:\n        return (((i * j) % 3) + ((i + j) % 2)) % 2 === 0\n\n      default:\n        throw new Error('bad maskPattern:' + maskPattern)\n    }\n  },\n\n  getErrorCorrectPolynomial (errorCorrectLength: number): QRPolynomial {\n    let a = new QRPolynomial([1], 0)\n    for (let i = 0; i < errorCorrectLength; i++) {\n      a = a.multiply(new QRPolynomial([1, QRMath.gexp(i)], 0))\n    }\n    return a\n  },\n\n  getLengthInBits (mode: number, type: any) {\n    if (type >= 1 && type < 10) {\n      // 1 - 9\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 10\n        case QRMode.MODE_ALPHA_NUM:\n          return 9\n        case QRMode.MODE_8BIT_BYTE:\n          return 8\n        case QRMode.MODE_KANJI:\n          return 8\n        default:\n          throw new Error('mode:' + mode)\n      }\n    } else if (type < 27) {\n      // 10 - 26\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 12\n        case QRMode.MODE_ALPHA_NUM:\n          return 11\n        case QRMode.MODE_8BIT_BYTE:\n          return 16\n        case QRMode.MODE_KANJI:\n          return 10\n        default:\n          throw new Error('mode:' + mode)\n      }\n    } else if (type < 41) {\n      // 27 - 40\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 14\n        case QRMode.MODE_ALPHA_NUM:\n          return 13\n        case QRMode.MODE_8BIT_BYTE:\n          return 16\n        case QRMode.MODE_KANJI:\n          return 12\n        default:\n          throw new Error('mode:' + mode)\n      }\n    } else {\n      throw new Error('type:' + type)\n    }\n  },\n\n  getLostPoint (qrCode: any) {\n    const moduleCount = qrCode.getModuleCount()\n    let lostPoint = 0\n    // LEVEL1\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount; col++) {\n        let sameCount = 0\n        const dark = qrCode.isDark(row, col)\n        for (let r = -1; r <= 1; r++) {\n          if (row + r < 0 || moduleCount <= row + r) {\n            continue\n          }\n          for (let c = -1; c <= 1; c++) {\n            if (col + c < 0 || moduleCount <= col + c) {\n              continue\n            }\n            if (r === 0 && c === 0) {\n              continue\n            }\n            if (dark === qrCode.isDark(row + r, col + c)) {\n              sameCount++\n            }\n          }\n        }\n        if (sameCount > 5) {\n          lostPoint += 3 + sameCount - 5\n        }\n      }\n    }\n    // LEVEL2\n    for (let row = 0; row < moduleCount - 1; row++) {\n      for (let col = 0; col < moduleCount - 1; col++) {\n        let count = 0\n        if (qrCode.isDark(row, col)) count++\n        if (qrCode.isDark(row + 1, col)) count++\n        if (qrCode.isDark(row, col + 1)) count++\n        if (qrCode.isDark(row + 1, col + 1)) count++\n        if (count === 0 || count === 4) {\n          lostPoint += 3\n        }\n      }\n    }\n    // LEVEL3\n    for (let row = 0; row < moduleCount; row++) {\n      for (let col = 0; col < moduleCount - 6; col++) {\n        if (\n          qrCode.isDark(row, col) &&\n          !qrCode.isDark(row, col + 1) &&\n          qrCode.isDark(row, col + 2) &&\n          qrCode.isDark(row, col + 3) &&\n          qrCode.isDark(row, col + 4) &&\n          !qrCode.isDark(row, col + 5) &&\n          qrCode.isDark(row, col + 6)\n        ) {\n          lostPoint += 40\n        }\n      }\n    }\n\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount - 6; row++) {\n        if (\n          qrCode.isDark(row, col) &&\n          !qrCode.isDark(row + 1, col) &&\n          qrCode.isDark(row + 2, col) &&\n          qrCode.isDark(row + 3, col) &&\n          qrCode.isDark(row + 4, col) &&\n          !qrCode.isDark(row + 5, col) &&\n          qrCode.isDark(row + 6, col)\n        ) {\n          lostPoint += 40\n        }\n      }\n    }\n\n    // LEVEL4\n    let darkCount = 0\n    for (let col = 0; col < moduleCount; col++) {\n      for (let row = 0; row < moduleCount; row++) {\n        if (qrCode.isDark(row, col)) {\n          darkCount++\n        }\n      }\n    }\n    const ratio = Math.abs((100 * darkCount) / moduleCount / moduleCount - 50) / 5\n    lostPoint += ratio * 10\n    return lostPoint\n  }\n}\n"]}