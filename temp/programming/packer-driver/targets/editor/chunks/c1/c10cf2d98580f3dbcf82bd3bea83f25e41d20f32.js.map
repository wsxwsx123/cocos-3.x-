{"version":3,"sources":["file:///Users/bane/cocos-3.x-qrcode2/assets/scripts/test.ts"],"names":["_decorator","Component","QRCode","QRErrorCorrectLevel","ccclass","property","test","cc","Node","ctx","start","ctxNode","getComponent","Graphics","addComponent","QRCreate","editBoxChange","data","log","url","qrcode","H","addData","make","fillColor","Color","BLACK","roll","Math","floor","getModuleCount","tileW","UITransform","width","tileH","height","clear","row","col","isDark","w","ceil","h","posx","round","posy","rect","WHITE","fill"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node } from \"cc\";\nimport { QRCode, QRErrorCorrectLevel } from \"./QRCode\";\nimport * as cc from \"cc\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"test\")\nexport class test extends Component {\n  @property(cc.Node)\n  ctxNode: Node;\n  ctx: cc.Graphics;\n\n  start() {\n    this.ctx = this.ctxNode.getComponent(cc.Graphics);\n    if (!this.ctx) {\n      this.ctx = this.ctxNode.addComponent(cc.Graphics);\n    }\n\n    //我的qq链接\n    this.QRCreate(\"https://qm.qq.com/q/z6T5CRZbfc&personal_qrcode_source=3\");\n  }\n\n  //输入框 内容发生变化\n  editBoxChange(data: String) {\n    cc.log(data);\n    this.QRCreate(data);\n  }\n\n  //绘制二维码\n  QRCreate(url) {\n    //根据QRCode来生成二维码数据\n    var qrcode = new QRCode(-1, QRErrorCorrectLevel.H);\n    qrcode.addData(url);\n    qrcode.make();\n\n    this.ctx.fillColor = cc.Color.BLACK;\n    let roll = Math.floor(qrcode.getModuleCount());\n    //块宽高\n    var tileW = this.ctxNode.getComponent(cc.UITransform).width / roll;\n    var tileH = this.ctxNode.getComponent(cc.UITransform).height / roll;\n    this.ctx.clear();\n    for (var row = 0; row < qrcode.getModuleCount(); row++) {\n      for (var col = 0; col < qrcode.getModuleCount(); col++) {\n        if (qrcode.isDark(row, col)) {\n          var w = Math.ceil((col + 1) * tileW) - Math.floor(col * tileW);\n          var h = Math.ceil((row + 1) * tileW) - Math.floor(row * tileW);\n          let posx =\n            Math.round(col * tileW) -\n            this.ctxNode.getComponent(cc.UITransform).width / 2;\n          let posy =\n            Math.round(row * tileH) -\n            this.ctxNode.getComponent(cc.UITransform).height / 2;\n\n          this.ctx.rect(posx, posy, w, h);\n          //颜色\n          this.ctx.fillColor = cc.Color.WHITE;\n          this.ctx.fill();\n        }\n      }\n    }\n  }\n\n}\n"]}